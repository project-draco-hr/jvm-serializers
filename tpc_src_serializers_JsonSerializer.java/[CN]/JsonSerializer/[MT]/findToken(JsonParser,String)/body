{
  JsonToken t;
  while ((t=parser.nextToken()) != null) {
    if (t == JsonToken.FIELD_NAME && parser.getCurrentName().equals(name)) {
      t=parser.nextToken();
      if (t == null) {
        throw new IllegalStateException("Missing value for attribute: " + name);
      }
      return t;
    }
  }
  throw new IllegalStateException("Could not find expected field: " + name);
}
